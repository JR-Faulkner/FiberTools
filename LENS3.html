<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><title>L.E.N.S. (Loss Estimator and Network Solver)</title><meta name="viewport" content="width=device-width,initial-scale=1"/><style>
body{font-family:Arial,sans-serif;text-align:center;padding:20px;margin:0;transition:background-color .5s,color .5s}
.app-title h1{font-size:2.2em;color:#f00;text-shadow:0 0 10px #f00,0 0 20px #f60;margin:0 0 5px}
.app-title .author{font-style:italic;font-size:1.05em;text-align:right;margin-right:20px;color:#0bf;animation:lightning 2s infinite}
@keyframes lightning{0%,19%,21%,23%,25%,54%,56%,100%{text-shadow:0 0 5px #0bf,0 0 15px #0ff,0 0 25px #0bf;color:#0ff}20%,24%,55%{text-shadow:none;color:#0bf}}
h2{margin:0;padding:15px;font-size:1.4em;cursor:pointer;background:linear-gradient(90deg,#f00,#0f0,#0bf);-webkit-background-clip:text;background-clip:text;color:transparent;-webkit-text-fill-color:transparent;transition:transform .3s;user-select:none}
h2:hover{transform:scale(1.03)}
.section{max-height:0;overflow:hidden;transition:max-height .35s;width:100%}
.section-inner{padding:12px 10px 18px;text-align:center}
label,select,input{font-size:1.05em;margin:8px;padding:6px 8px;border-radius:6px}
input[type=number]{width:160px}
button{padding:10px 18px;margin-top:12px;border-radius:6px;cursor:pointer;transition:all .3s;border:1px solid transparent}
button:hover{transform:scale(1.04);box-shadow:0 0 10px #0f0}
#result,#ribbonResult{margin-top:16px;font-size:1.1em;font-weight:bold;opacity:0;transform:translateY(8px);transition:opacity .25s,transform .25s;white-space:pre-line}
#result.show,#ribbonResult.show{opacity:1;transform:translateY(0)}
body.dark{background:#000;color:#f00}
body.dark input,body.dark select{background:#111;color:#f00;border:1px solid #f00}
body.dark button{background:#111;color:#0f0;border:1px solid #0f0}
body.dark button:hover{background:#0f0;color:#000}
body.dark #result,body.dark #ribbonResult{color:#0bf}
body.light{background:#fff;color:#000}
body.light input,body.light select{background:#f0f0f0;color:#000;border:1px solid #000}
body.light button{background:#eee;color:#000;border:1px solid #000}
body.light button:hover{background:#000;color:#fff}
body.light #result,body.light #ribbonResult{color:#07c}
.switch{position:relative;display:inline-block;width:80px;height:40px}
.switch input{opacity:0;width:0;height:0}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#444;transition:.4s;border-radius:40px}
.slider:before{position:absolute;content:"";height:32px;width:32px;left:4px;bottom:4px;background:#fff;transition:.4s;border-radius:50%}
input:checked+.slider{background:#2196F3}
input:checked+.slider:before{transform:translateX(40px)}
</style></head><body class="dark">
<div class="app-title"><h1>L.E.N.S. – Loss Estimator and Network Solver</h1><p class="author">By: Jovan Faulkner</p></div>
<h2 onclick="toggleSection('lossSection')">Fiber Loss Calculator ▼</h2>
<div id="lossSection" class="section"><div class="section-inner">
<label>Distance: <input id="distance" type="number"></label>
<label>Unit:<select id="unit"><option value="km">km</option><option value="ft">feet</option></select></label><br>
<label>Wavelength:<select id="wavelength"><option value="850">850 nm</option><option value="1310">1310 nm</option><option value="1490">1490 nm</option><option value="1550" selected>1550 nm</option><option value="1625">1625 nm</option></select></label><br>
<label>Connectors: <input id="connectors" type="number"></label>
<label>Loss per connector:<select id="connectorLoss"><option value="0.45">0.45 dB</option><option value="0.55">0.55 dB</option><option value="0.75">0.75 dB</option></select></label><br>
<label>Splice Mode:<select id="spliceMode" onchange="handleSpliceMode()"><option value="same" selected>Same loss per splice</option><option value="custom">Custom loss per splice</option></select></label><br>
<div id="sameLossInputs"><label>Splices: <input id="splices" type="number"></label>
<label>Loss per splice:<select id="spliceLoss"><option value="0.03">0.03 dB</option><option value="0.05">0.05 dB</option><option value="0.10">0.10 dB</option></select></label></div>
<button onclick="calcLoss()">Calculate Total Loss</button><p id="result"></p></div></div>
<h2 onclick="toggleSection('ribbonSection')">Fiber Ribbon Finder ▼</h2>
<div id="ribbonSection" class="section"><div class="section-inner">
<label>Strand Number: <input id="strand" type="number"></label><br>
<button onclick="findRibbon()">Find Ribbon</button><p id="ribbonResult"></p></div></div>
<h2 onclick="toggleSection('themeSection')">Theme Mode ▼</h2>
<div id="themeSection" class="section"><div class="section-inner">
<label class="switch"><input type="checkbox" id="themeToggle" onchange="toggleTheme()"><span class="slider"></span></label>
<p>Toggle Light/Dark Mode</p></div></div>
<script>
let customSpliceLosses=[];
function setSectionHeight(s){s.style.maxHeight='none';s.style.maxHeight=s.scrollHeight+'px'}
function toggleSection(id){const s=document.getElementById(id);const open=s.style.maxHeight&&s.style.maxHeight!=='0px';s.style.maxHeight=open?'0px':s.scrollHeight+'px'}
window.addEventListener('resize',()=>['lossSection','ribbonSection','themeSection'].forEach(id=>{const s=document.getElementById(id);if(s.style.maxHeight&&s.style.maxHeight!=='0px')setSectionHeight(s)}));
function handleSpliceMode(){const mode=document.getElementById("spliceMode").value;const same=document.getElementById("sameLossInputs");if(mode==="same"){same.style.display="block"}else{same.style.display="none";const c=parseInt(prompt("How many splices?"),10);if(!isNaN(c)&&c>0){customSpliceLosses=[];for(let i=1;i<=c;i++){let loss=parseFloat(prompt(`Enter loss for splice ${i} (dB):`));customSpliceLosses.push(isNaN(loss)?0:loss)}}}calcLoss()}
function calcLoss(){const dist=parseFloat(document.getElementById('distance').value)||0;const unit=document.getElementById('unit').value;const wl=document.getElementById('wavelength').value;const connectors=parseInt(document.getElementById('connectors').value)||0;const connectorLoss=parseFloat(document.getElementById('connectorLoss').value);const mode=document.getElementById('spliceMode').value;const coeffs={'850':2.5,'1310':0.35,'1490':0.25,'1550':0.20,'1625':0.30};let km=unit==='ft'?dist/3280.84:dist;const fiberLoss=(coeffs[wl]||0.2)*km;const connLoss=connectors*connectorLoss;let spliceLoss=0;if(mode==="same"){const s=parseInt(document.getElementById('splices').value)||0;const sl=parseFloat(document.getElementById('spliceLoss').value);spliceLoss
