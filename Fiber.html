<!DOCTYPE html>
<html>
<head>
  <title>Fiber Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      transition: background-color 0.5s ease, color 0.5s ease;
    }

    /* Title Block */
    .app-title { text-align: center; margin-bottom: 20px; }
    .app-title h1 {
      font-size: 2.4em;
      color: #ff0000;
      text-shadow: 0 0 10px #ff0000, 0 0 20px #ff6600;
      margin-bottom: 5px;
    }
    .app-title .author {
      font-style: italic;
      font-size: 1.1em;
      text-align: right;
      margin-right: 20px;
      color: #00bfff;
      animation: lightning 2s infinite;
    }
    @keyframes lightning {
      0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
        text-shadow: 0 0 5px #00bfff, 0 0 15px #00ffff, 0 0 25px #00bfff;
        color: #00ffff;
      }
      20%, 24%, 55% {
        text-shadow: none;
        color: #00bfff;
      }
    }

    /* Section headers with gradient text */
    h2 {
      margin: 0;
      padding: 15px;
      font-size: 1.5em;
      cursor: pointer;
      background: linear-gradient(90deg, #ff0000, #00ff00, #00bfff);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      -webkit-text-fill-color: transparent;
      transition: transform 0.3s ease;
    }
    h2:hover { transform: scale(1.05); }

    /* Accordion sections (dynamic height) */
    .section {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
    }

    label, select, input {
      font-size: 1.05em;
      margin: 8px;
      padding: 6px 8px;
      border-radius: 6px;
    }

    button {
      padding: 10px 18px;
      margin-top: 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #00ff00;
    }

    #result, #ribbonResult {
      margin-top: 16px;
      font-size: 1.2em;
      font-weight: bold;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    #result.show, #ribbonResult.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* Dark mode */
    body.dark { background-color: #000; color: #ff0000; }
    body.dark input, body.dark select {
      background-color: #111; color: #ff0000; border: 1px solid #ff0000;
    }
    body.dark button {
      background-color: #111; color: #00ff00; border: 1px solid #00ff00;
    }
    body.dark button:hover { background-color: #00ff00; color: #000; }
    body.dark #result, body.dark #ribbonResult { color: #00bfff; }

    /* Light mode */
    body.light { background-color: #fff; color: #000; }
    body.light input, body.light select {
      background-color: #f0f0f0; color: #000; border: 1px solid #000;
    }
    body.light button {
      background-color: #eee; color: #000; border: 1px solid #000;
    }
    body.light button:hover { background-color: #000; color: #fff; }
    body.light #result, body.light #ribbonResult { color: #0077cc; }

    .highlight-green { color: #00ff00; }
    .highlight-blue  { color: #00bfff; }

    /* Toggle switch */
    .switch { position: relative; display: inline-block; width: 60px; height: 34px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider {
      position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc; transition: .4s; border-radius: 34px;
    }
    .slider:before {
      position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px;
      background-color: white; transition: .4s; border-radius: 50%;
    }
    input:checked + .slider { background-color: #2196F3; }
    input:checked + .slider:before { transform: translateX(26px); }
  </style>
</head>
<body class="dark">

  <!-- Title Block -->
  <div class="app-title">
    <h1>F.I.B.E.R. – Field Integrated Build & Engineering Resource</h1>
    <p class="author">By: Jovan Faulkner</p>
  </div>

  <!-- Fiber Loss Calculator -->
  <h2 onclick="toggleSection('lossSection')">Fiber Loss Calculator ▼</h2>
  <div id="lossSection" class="section">
    <label>Distance: <input id="distance" type="number" placeholder="Enter value"></label>
    <label>Unit:
      <select id="unit">
        <option value="km">km</option>
        <option value="ft">feet</option>
      </select>
    </label><br>

    <label>Wavelength:
      <select id="wavelength">
        <option value="850">850 nm</option>
        <option value="1310">1310 nm</option>
        <option value="1490">1490 nm</option>
        <option value="1550" selected>1550 nm</option>
        <option value="1625">1625 nm</option>
      </select>
    </label><br>

    <label>Connectors: <input id="connectors" type="number" placeholder="0"></label>
    <label>Loss per connector:
      <select id="connectorLoss">
        <option value="0.45">0.45 dB</option>
        <option value="0.55">0.55 dB</option>
        <option value="0.75">0.75 dB</option>
      </select>
    </label><br>

    <label>Splices: <input id="splices" type="number" placeholder="0"></label>
    <label>Loss per splice:
      <select id="spliceLoss">
        <option value="0.03">0.03 dB</option>
        <option value="0.05">0.05 dB</option>
        <option value="0.10">0.10 dB</option>
      </select>
    </label><br>

    <button onclick="calcLoss()">Calculate Total Loss</button>
    <p id="result"></p>
  </div>

  <!-- Ribbon Finder -->
  <h2 onclick="toggleSection('ribbonSection')">Fiber Ribbon Finder ▼</h2>
  <div id="ribbonSection" class="section">
    <label>Strand Number: <input id="strand" type="number" placeholder="Enter strand #"></label><br>
    <button onclick="findRibbon()">Find Ribbon</button>
    <p id="ribbonResult"></p>
  </div>

  <!-- Theme -->
  <h2 onclick="toggleSection('themeSection')">Theme Settings ▼</h2>
  <div id="themeSection" class="section">
    <label class="switch">
      <input type="checkbox" id="themeToggle" onchange="toggleTheme()">
      <span class="slider"></span>
    </label>
    <p>Toggle Light/Dark Mode</p>
  </div>

  <script>
    // Smooth dynamic accordion
    function toggleSection(id) {
      const section = document.getElementById(id);
      const isOpen = section.style.maxHeight && section.style.maxHeight !== "0px";

      if (isOpen) {
        section.style.maxHeight = "0px";
      } else {
        section.style.maxHeight = section.scrollHeight + "px";
      }
    }

    // Recompute expanded height on content change (optional safety)
    function recalcSection(id) {
      const section = document.getElementById(id);
      if (section.style.maxHeight && section.style.maxHeight !== "0px") {
        section.style.maxHeight = section.scrollHeight + "px";
      }
    }

    function calcLoss() {
      let d = parseFloat(document.getElementById("distance").value) || 0;
      const unit = document.getElementById("unit").value;
      const wl = document.getElementById("wavelength").value;

      const connectors = parseInt(document.getElementById("connectors").value) || 0;
      const connectorLoss = parseFloat(document.getElementById("connectorLoss").value) || 0.45;

      const splices = parseInt(document.getElementById("splices").value) || 0;
      const spliceLoss = parseFloat(document.getElementById("spliceLoss").value) || 0.05;

      if (unit === "ft") d = d * 0.0003048; // convert feet to km

      const coeffs = { "850": 2.5, "1310": 0.35, "1490": 0.25, "1550": 0.20, "1625": 0.30 };

      const fiberLoss = d * (coeffs[wl] || 0);
      const connLoss = connectors * connectorLoss;
      const spliceLossTotal = splices * spliceLoss;
      const totalLoss = fiberLoss + connLoss + spliceLossTotal;

      const res = document.getElementById("result");
      res.innerHTML =
        "Fiber Loss at <span class='highlight-blue'>" + wl + " nm</span>: " +
        fiberLoss.toFixed(2) + " dB<br>" +
        "Connector Loss (" + connectors + " × " + connectorLoss + " dB): " + connLoss.toFixed(2) + " dB<br>" +
        "Splice Loss (" + splices + " × " + spliceLoss + " dB): " + spliceLossTotal.toFixed(2) + " dB<br>" +
        "<span class='highlight-green'>Total Link Loss: " + totalLoss.toFixed(2) + " dB</span>";
      res.classList.remove("show"); void res.offsetWidth; res.classList.add("show");

      // Ensure section height accounts for new result content
      recalcSection('lossSection');
    }

    function findRibbon() {
      const strand = parseInt(document.getElementById("strand").value);
      const res = document.getElementById("ribbonResult");
      if (isNaN(strand) || strand < 1) {
        res.innerText = "Please enter a valid strand number.";
        res.classList.remove("show"); void res.offsetWidth; res.classList.add("show");
        recalcSection('ribbonSection');
        return;
      }
      const colors = ["Blue","Orange","Green","Brown","Slate (Gray)","White","Red","Black","Yellow","Violet","Rose (Pink)","Aqua"];
      const ribbon = Math.ceil(strand / 12);
      const pos = ((strand - 1) % 12);
      const color = colors[pos];
      res.innerHTML = "Strand <span class='highlight-blue'>" + strand + "</span> is in Ribbon <span class='highlight-green'>" + ribbon + "</span>, Color: <span class='highlight-green'>" + color + "</span>";
      res.classList.remove("show"); void res.offsetWidth; res.classList.add("show");
      recalcSection('ribbonSection');
    }

    function toggleTheme() {
      const body = document.body;
      const checked = document.getElementById("themeToggle").checked;
      body.classList.toggle("light", checked);
      body.classList.toggle("dark", !checked);
    }

    // Open the first section on load for usability
    document.addEventListener('DOMContentLoaded', () => {
      const first = document.getElementById('lossSection');
      first.style.maxHeight = first.scrollHeight + "px";
    });

    // Keep accordion responsive if fonts load or viewport changes
    window.addEventListener('resize', () => {
      ['lossSection','ribbonSection','themeSection'].forEach(recalcSection);
    });
  </script>
</body>
</html>